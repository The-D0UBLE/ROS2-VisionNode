# YOLOv8 Segmentation Project

This repository contains a **YOLOv8-based semantic segmentation pipeline**. It includes scripts for:

* Dataset preparation (`check_env.py`)
* Training YOLOv8 segmentation models
* Evaluating trained models with visual overlays (`evaluation.py`)

---

## Table of Contents

* [Project Structure](#project-structure)
* [Setup](#setup)
* [Dataset Preparation](#dataset-preparation)
* [Training](#training)
* [Evaluation](#evaluation)
* [Configuration](#configuration)
* [Notes](#notes)

---

## Project Structure

```text
yolo-segmentation-project/
├── data/
│   ├── train/images
│   ├── valid/images
│   ├── test/images
│   └── yolo-dataset/
│       └── data.yaml          # Roboflow dataset export
├── config/
│   └── train.yaml              # Training configuration
├── scripts/
│   ├── check_env.py            # Environment & dataset sanity check
│   └── evaluation.py           # Evaluate trained model and visualize results
├── runs/                        # YOLOv8 training outputs (weights, logs)
├── README.md
└── requirements.txt
```

---

## Dataset Preparation

* Export your semantic segmentation dataset from Roboflow in **YOLOv8-segmentation format**.
* Make sure the folder structure looks like:

```
data/
├── train/images
├── valid/images
├── test/images
└── yolo-dataset/data.yaml
```

* Run the environment & dataset sanity check:

```bash
python scripts/check_env.py
```

This will print:

* Python, PyTorch, CUDA, and Ultralytics versions
* Number of images in `train`, `valid`, and `test` splits
* Warnings if paths are missing or invalid

---

## Training

1. Edit `config/train.yaml` to configure your training:

```yaml
data_yaml: data/yolo-dataset/data.yaml
epochs: 70
batch: 32
imgsz: 640
name: my_yolov8_seg_run
```

2. Train the YOLOv8 segmentation model:

```python
from ultralytics import YOLO

model = YOLO('yolov8n-seg.pt')  # base model
model.train(
    data='config/train.yaml',
    epochs=70,
    imgsz=640,
    batch=32,
    name='my_yolov8_seg_run',
    exist_ok=True
)
```

* Training logs and weights are saved to `runs/segment/my_yolov8_seg_run/`.
* After training, `best.pt` contains the best-performing model.

---

## Evaluation

Evaluate and visualize your trained model using `evaluation.py`:

```bash
python scripts/evaluation.py
```

Options:
* `--model:` path to the trained YOLOv8 segmentation model (.pt)
* `--images:` folder containing images to evaluate
* `--data_yaml`: path to `data/yolo-dataset/data.yaml` (default: `data/yolo-dataset/data.yaml`)
* `--imgsz`: image resize for inference (default: 640)
* `--conf`: confidence threshold for predictions (default: 0.50)

Features:

* Uses class names directly from `data.yaml` to avoid mismatch errors
* Generates distinct colors per class
* Overlay masks on original images
* Displays legend with class names

---

## Configuration

* `config/train.yaml`: training parameters and dataset path
* `data/yolo-dataset/data.yaml`: contains dataset splits and class names (generated by Roboflow)
* `scripts/check_env.py`: checks environment, CUDA, dataset paths, and prints number of images per split
* `scripts/evaluation.py`: runs inference and shows overlayed segmentation masks

---

## Notes

* Ensure **train, valid, and test images** are placed **outside of `yolo-dataset`**, alongside it. Roboflow’s `data.yaml` uses relative paths. Example:

```
data/
├── train/images
├── valid/images
├── test/images
└── yolo-dataset/data.yaml
```

* Recommended to use **GPU** for training and inference to reduce runtime.

---


